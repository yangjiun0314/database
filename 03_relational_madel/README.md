# Week 03 — Relational Model & Integrity Constraints 
---

## 1. 릴레이션 기본

- **릴레이션 스키마** `R(A1, A2, …, An)`  
  R은 이름, 각 `Ai`는 **속성(칼럼)**, 각 속성은 **도메인**(값의 집합)에 속함.
- **릴레이션 인스턴스** `r(R)`는 **투플(행)** 들의 유한 집합.  
  행의 순서는 의미 없고, 중복 투플은 없다(집합).
- **차수(degree)** = 속성의 개수, **기수(cardinality)** = 투플 수.
- **1NF(원자성)**: 속성 값은 분해되지 않는 원자값(리스트/배열 저장 X).

### 도메인과 타입
- 타입(정수, 실수, 문자열, **DATE/ TIME** 등) + 허용 범위/형식.  
- **DATE 타입**은 *표기와 무관하게* 같은 날짜면 같은 값.  
  예: `'12-DEC-60'`, `'1960-12-12'`는 같은 DATE 값으로 취급.

### NULL
- **알 수 없음 / 미정 / 해당 없음**을 나타내는 특수 마커.  
- 비교 시 **3값 논리**(TRUE, FALSE, UNKNOWN)가 필요 → 조인/집계 시 주의.

---

## 2. 키 (Keys)

- **수퍼키(Superkey)**: 투플을 **유일하게 식별**하는 속성 집합 X.  
  - 판정: `|π_X(r)| = |r|` 이면 X는 r에서 수퍼키.
  - 단조성: X가 수퍼키면 X⊆Y ⇒ Y도 수퍼키.
- **키(Key) / 후보키(Candidate key)**: **최소 수퍼키**(진부분집합은 수퍼키가 아님).
- **기본키(Primary key)**: 후보키 중 채택된 하나(나머지는 **대체키**).  
  - 기본키는 가능하면 **짧고, 변하지 않고, NULL 금지**가 적합.
- **복합키**: 둘 이상의 속성으로 이루어진 키.

> 기억 포인트  
> • 수퍼키는 “유일성”만, 키는 “유일성 + 최소성”.  
> • 키가 정해지면 **함수적 종속** `Key → (나머지 속성 전부)`가 성립.

---

## 3. 무결성 제약 (Integrity Constraints)

1) **도메인 제약**  
   - 타입/범위/패턴/체크 제약을 위반하면 오류.  
   - 예: `Hours`가 음수, `Bdate`가 불가능한 날짜 등.

2) **키 제약(유일성)**  
   - **PK/UNIQUE** 속성(조합)의 **중복** 금지.

3) **엔터티 무결성**  
   - **기본키의 어떤 속성도 NULL 불가**.

4) **참조 무결성(외래키)**  
   - FK가 **NULL이 아니면** 참조하는 테이블의 **PK 값이 존재**해야 함.  
   - 부모(참조 대상) 삭제/수정 시 옵션:
     - **RESTRICT/NO ACTION**: 자식이 있으면 거부
     - **CASCADE**: 자식도 함께 삭제/수정
     - **SET NULL / SET DEFAULT**: 자식 FK를 NULL/기본값으로

> 실수 방지:  
> • **키 중복 → 키 제약**, **PK에 NULL → 엔터티**, **부모 미존재/삭제 → 참조**,  
> • **타입/범위/체크 → 도메인**.

---

## 4. 외래키 예시 (텍스트로 이해)

- `ENROLL(StudentID, CourseID, Semester, Year)`  
  - PK: `(StudentID, CourseID, Semester, Year)`  
  - FK: `StudentID → STUDENT(StudentID)`, `CourseID → COURSE(CourseID)`  
  - `STUDENT` 삭제 시:  
    - `ON DELETE CASCADE`면 해당 학생의 ENROLL 투플도 같이 삭제.  
    - `RESTRICT`면 ENROLL이 남아있으면 삭제 거부.

---

## 5. 설계 가이드

- **의미 보존**: 한 속성은 한 의미만. 파생 속성(총액 등)은 가급적 저장 X.  
- **중복 최소화**: 중복은 갱신 이상(Anomaly)을 낳음.  
- **NULL 최소화**: NULL이 많은 속성은 분리 고려.  
- **조인 시 스퓨리어스 투플 방지**: 의미 있는 키로 조인하도록 스키마/키 설계.  
- (정규화 예고) 2NF/3NF/BCNF로 개선.

---

## 6. 빠른 체크

- [ ] `수퍼키 ↔ |π_X(r)| = |r|` 의미를 정확히 설명할 수 있다.  
- [ ] 키/후보키/기본키 차이를 **예시**로 말할 수 있다.  
- [ ] 4대 제약에서 **어떤 상황이 어떤 제약 위반**인지 즉시 분류할 수 있다.  
- [ ] FK 동작(CASCADE/RESTRICT/SET NULL)을 실제 문장으로 설명할 수 있다.  
- [ ] DATE 값은 **표기 다름**이 허용됨을 알고 있다.